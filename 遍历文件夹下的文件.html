<!DOCTYPE html>
<html>
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=cp936">
    <title>遍历文件夹下的文件</title>
    <link rel="stylesheet" type="text/css" href="css/shCoreDefault.css"/>
    <link rel="Stylesheet" type="text/css" href="static/css/wiki.css">
    <link rel="Stylesheet" type="text/css" href="static/bootstrap/css/bootstrap.min.css">
    <script type="text/javascript" src="static/js/jquery.min.js"></script>
    <script type="text/javascript" src="static/bootstrap/js/bootstrap.min.js"></script>
    <script type="text/javascript" src="static/js/wiki.js"></script>
    <script type="text/javascript" src="static/js/shCore.js"></script>
    <script type="text/javascript" src="static/js/shBrushPython.js"></script>
    <script type="text/javascript" src="static/js/shBrushCpp.js"></script>
    <script type="text/javascript" src="static/js/shBrushErlang.js"></script>
    <script type="text/javascript" src="static/js/shBrushBash.js"></script>
    <script type="text/javascript" src="static/js/shBrushRuby.js"></script>
    <script type="text/javascript" src="static/js/shBrushSql.js"></script>
    <script type="text/javascript" src="static/js/shBrushJScript.js"></script>
    <script type="text/javascript">SyntaxHighlighter.all();</script>
</head>
<body>
<nav class="navbar navbar-default navbar-inverse" role="navigation">
 <div class="container">
    <div class="navbar-header">
<button data-target=".bs-navbar-collapse" data-toggle="collapse" type="button" class="navbar-toggle">
	<span class="sr-only"></span>
	<span class="icon-bar"></span>
	<span class="icon-bar"></span>
	<span class="icon-bar"></span>
      </button>
	<a class="navbar-brand" href="main.html">Rick's wiki</a>
    </div>
    <div class="collapse navbar-collapse">
	<ul class="nav navbar-nav">
	    <li><a href="main.html">Home</a></li>
	    <li><a href="TODO.html">TODO</a></li>
	</ul>
    </div>
 </div>
</nav>
<div class="container content-body">
    
<div class="toc">
<ul>
<li><a href="#toc_0.1">遍历文件夹下的文件</a>
<ul>
<li><a href="#toc_0.1.1">只遍历当前文件夹下的文件（不进入目录）</a>
<li><a href="#toc_0.1.2">遍历文件夹下的所有文件包含子目录下的文件</a>
</ul>
</ul>
</ul>
</div>
<h2 id="toc_0.1">遍历文件夹下的文件</h2>
<h3 id="toc_0.1.1">只遍历当前文件夹下的文件（不进入目录）</h3>
<ul>
<li>
  os.listdir  列出当前文件夹下的所有文件及目录
<pre class = "brush: python">
import os
for filename in os.listdir(r'e:\HRDoc')
    if os.path.isfile(filename):
        print "*file: %s" % filename
    else if os.path.isdir(filename):
        print "#dir: %s" % filename
    else
        print "$other: %s" % filename
</pre>

</ul>

<ul>
<li>
  <a href="http://docs.python.org/2/library/glob.html">glob</a>    The glob module finds all the pathnames matching a specified pattern according to the rules used by the Unix shell
<pre class = "brush: python">
import glob
for filename in glob.glob(r'e:\HRDoc\*.etl')
    print filename
glob.glob('./[0-9].*')
</pre>

</ul>

<h3 id="toc_0.1.2">遍历文件夹下的所有文件包含子目录下的文件</h3>
<ul>
<li>
  os.path.walk(top, func, arg)
<pre>
1&gt;参数top表示需要遍历的目录树的路径
2&gt;参数func表示回调函数，对遍历路径进行处理.所谓回调函数，是作为某个函数的参数使用，
  当某个时间触发时，程序将调用定义好的回调函数处理某个任务.回调函数必须提供3个参数
  第1个参数为walk()的参数tag，第2个参数表示目录列表，第3个参数表示文件列表
  注意：os.path.walk的回调函数中的文件列表不和os.walk()那样将子目录和文件分开，
        而是混为了一摊，需要在回调函数中判断是文件还是子目录。

3&gt;参数arg是传递给回调参数func的元组.回调函数的一个参数必须是arg，为回调函数提供处理参数.参数arg可以为空

过程：以top 为根的目录树中的每一个目录 (包含 top 自身，如果它是一个目录)，以参数 (arg, dirname, names)调用回调函数 funct。
      参数 dirname 指定访问的目录，参数 names 列出在目录中的文件(从 os.listdir(dirname)中得到)。回调函数可以修改 names 
      改变 dirname 下面访问的目录的设置，例如，避免访问树的某一部分。(由 names 关连的对象必须在合适的位置被修改，使用 del
      或 slice 指派。) 注意：符号连接到目录不被作为一个子目录处理，并且因此 walk()将不访问它们。访问连接的目录你必须以
      os.path.islink(file) 和 os.path.isdir(file)标识它们，并且必须调用walk() 
</pre>
<pre class = "brush: python">
import os.path
def processDir(args, dirname, filenames):
    print 'Directory: %s' % dirname
    for filename in filenames:
        print 'File: %s' % filename

os.path.walk(r"e:\HRDir", processDir, ())
</pre>

</ul>

<ul>
<li>
  os.walk(top, topdown=True, onerror=None)
<pre>
1&gt;参数top表示需要遍历的目录树的路径
2&gt;参数topdown的默认值是"True",表示首先返回目录树下的文件，然后在遍历目录树的子目录.
  参数topdown的值为"False"时，则表示先遍历目录树的子目录，返回子目录下的文件，最后返回根目录下的文件
3&gt;参数onerror的默认值是"None",表示忽略文件遍历时产生的错误.如果不为空，则提供一个自定义函数提示错误信息后继续遍历或抛出异常中止遍历
4&gt;该函数返回一个元组，该元组有3个元素，这3个元素分别表示每次遍历的路径名，目录列表和文件列表
</pre>

</ul>

<pre class = "brush: python">
import os

def Remove_dir(top_dir):
    if os.path.exists(top_dir)==False:
        print "not exists"
        return
    if os.path.isdir(top_dir)==False:
        print "not a dir"
        return
    for dir_path,subpaths,files in os.walk(top_dir,False):
        for file in files:
            file_path=os.path.join(dir_path,file)
            print "delete file:%s"  %file_path
            os.remove(file_path)
        print "delete dir:%s" %dir_path
        os.rmdir(dir_path)
#delete one directory
Remove_dir(r"e:\etldir")
</pre>

<dl>
<dt><strong>Note</strong></dt>
</dl>
<p>
os.path.walk()与os.walk()产生的文件名列表并不相同:
<br>os.path.walk()产生目录树下的目录路径和文件路径(文件列表和子目录列表)
<br>而os.walk()只产生文件路径(子目录与文件的混合列表)
</p>


   <hr />
   <div id="disqus_thread"></div>
    <script type="text/javascript">
        var disqus_shortname = 'rickhuang'; // required: replace example with your forum shortname

        (function() {
            var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
            dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
            (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
        })();
    </script>
    <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
    <a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
</div>
</body>
</html>
