<!DOCTYPE html>
<html>
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=cp936">
    <title>parse cmd line argument</title>
    <link rel="stylesheet" type="text/css" href="css/shCoreDefault.css"/>
    <link rel="Stylesheet" type="text/css" href="static/css/wiki.css">
    <link rel="Stylesheet" type="text/css" href="static/bootstrap/css/bootstrap.min.css">
    <script type="text/javascript" src="static/js/jquery.min.js"></script>
    <script type="text/javascript" src="static/bootstrap/js/bootstrap.min.js"></script>
    <script type="text/javascript" src="static/js/wiki.js"></script>
    <script type="text/javascript" src="static/js/shCore.js"></script>
    <script type="text/javascript" src="static/js/shBrushPython.js"></script>
    <script type="text/javascript" src="static/js/shBrushCpp.js"></script>
    <script type="text/javascript" src="static/js/shBrushErlang.js"></script>
    <script type="text/javascript" src="static/js/shBrushBash.js"></script>
    <script type="text/javascript" src="static/js/shBrushRuby.js"></script>
    <script type="text/javascript" src="static/js/shBrushSql.js"></script>
    <script type="text/javascript" src="static/js/shBrushJScript.js"></script>
    <script type="text/javascript">SyntaxHighlighter.all();</script>
</head>
<body>
<nav class="navbar navbar-default navbar-inverse" role="navigation">
 <div class="container">
    <div class="navbar-header">
<button data-target=".bs-navbar-collapse" data-toggle="collapse" type="button" class="navbar-toggle">
	<span class="sr-only"></span>
	<span class="icon-bar"></span>
	<span class="icon-bar"></span>
	<span class="icon-bar"></span>
      </button>
	<a class="navbar-brand" href="main.html">Rick's wiki</a>
    </div>
    <div class="collapse navbar-collapse">
	<ul class="nav navbar-nav">
	    <li><a href="main.html">Home</a></li>
	    <li><a href="TODO.html">TODO</a></li>
	</ul>
    </div>
 </div>
</nav>
<div class="container content-body">
    
<div class="toc">
<ul>
<li><a href="#toc_1">Cmd line argument</a>
<ul>
<li><a href="#toc_1.1">sys</a>
<li><a href="#toc_1.2">argparse</a>
<li><a href="#toc_1.3">Usage</a>
<li><a href="#toc_1.4">Examples</a>
</ul>
</ul>
</div>
<h1 id="toc_1">Cmd line argument</h1>

<h2 id="toc_1.1">sys</h2>
<ul>
<li>
  sys.argv
<pre class = "brush: python">
if __name__ == '__main__':
    import sys
    print len(sys.argv)
    print sys.argv[0]   #command itself
    print sys.argv[1]   #the first parameter
</pre>

</ul>

<h2 id="toc_1.2">argparse</h2>
<ul>
<li>
  <a href="http://docs.python.org/2/howto/argparse.html">Tutorial</a>

<li>
  <a href="http://docs.python.org/2/library/argparse.html#nargs">Docs</a>

</ul>


<h2 id="toc_1.3">Usage</h2>
<ul>
<li>
  Positional arguments

</ul>
<p>
<strong>Running program always need an argument</strong>
</p>

<pre class = "brush: python">
import argparse
parser = argparse.ArgumentParser()
parser.add_argument("echo", help="echo the string you use here")
parser.add_argument("square", help="display a square of a given number", type=int)
args = parser.parse_args()
print args.square**2
print args.echo
</pre>

<p>
Running:
</p>
<pre>
    $ python prog.py -h
    usage: prog.py [-h] echo

    positional arguments:
      echo        echo the string you use here
      square      display a square of a given number

    optional arguments:
      -h, --help  show this help message and exit

    $ python prog.py foo 4
    16
    foo
</pre>

<ul>
<li>
  Optional arguments

</ul>
<p>
<strong>arguments are optional</strong>
</p>
<pre class = "brush: python">
import argparse
parser = argparse.ArgumentParser()
parser.add_argument("-v","--verbose", help="increase output verbosity",
                    action="store_true")
args = parser.parse_args()
if args.verbose:
   print "verbosity turned on"
</pre>

<p>
Running:
</p>
<pre>
    $ python prog.py --verbose
    verbosity turned on
    $ python prog.py --verbose 1
    usage: prog.py [-h] [--verbose]
    prog.py: error: unrecognized arguments: 1
    $ python prog.py --help
    usage: prog.py [-h] [--verbose]

    optional arguments:
      -h, --help  show this help message and exit
      -v, --verbose   increase output verbosity
</pre>

<dl>
<dt><strong>Note</strong></dt>
</dl>
<p>
We now specify a new keyword, _<em>action</em>_, and give it the value "store_true". 
<br>This means that, if the option is specified, assign the value True to args.verbose. 
<br>Not specifying it implies False
</p>

<ul>
<li>
  The add_argument() method

</ul>
<p>
<strong>ArgumentParser.add_argument(name or flags...[, action][, nargs][, const][, default][, type][, choices][, required][, help][, metavar][, dest])</strong>
</p>
<pre>
    name or flags - Either a name or a list of option strings, e.g. foo or -f, --foo.
    action - The basic type of action to be taken when this argument is encountered at the command line.
    nargs - The number of command-line arguments that should be consumed.
    const - A constant value required by some action and nargs selections.
    default - The value produced if the argument is absent from the command line.
    type - The type to which the command-line argument should be converted.
    choices - A container of the allowable values for the argument.
    required - Whether or not the command-line option may be omitted (optionals only).
    help - A brief description of what the argument does.
    metavar - A name for the argument in usage messages.
    dest - The name of the attribute to be added to the object returned by parse_args().
</pre>

<h2 id="toc_1.4">Examples</h2>
<pre class = "brush: python">
import argparse
    parser.add_argument("-e", "--examples", help="show examples", action='store_true')
    parser.add_argument("-s", "--single", nargs=2, help="Only convert one etl file to text")
    parser.add_argument("-m", "--multiple", nargs=2, help="Convert more than one etl files to text")
    parser.add_argument("-l", "--level", type=int, nargs=1, help="Select level when convert")
    parser.add_argument("-v", "--view", nargs=1, help="Open the log file after convert")
    args = parser.parse_args()
    if args.examples:
        Showhelp()
    if args.level is not None:
        print "log level is %d" % args.level[0]
        LevelNum = int(args.level[0])

    if args.single is not None: 
        print args.single
        # check the file ext
        filename1, ext1 = os.path.splitext(args.single[0]) 
        filename2, ext2 = os.path.splitext(args.single[1]) 
        if cmp(ext1,'.etl') == 0 and cmp(ext2, '.pdb') == 0:
            #Deal the case
            if args.view is not None:
                DealOneFile(args.single[0], args.single[1], args.view[0])
            else:
                DealOneFile(args.single[0], args.single[1])
        else:
            #print help
            print Showhelp() 

    if args.multiple is not None:
        print args.multiple
        # check the dir and the file ext
        filename2, ext3 = os.path.splitext(args.multiple[1]);
        if os.path.isdir(args.multiple[0]) and cmp(ext3, '.pdb') == 0:
            #Deal the case
            DealMultipleFiles(args.multiple[0], args.multiple[1])
        else:
            #print help
            print Showhelp()
</pre>


   <hr />
   <div id="disqus_thread"></div>
    <script type="text/javascript">
        var disqus_shortname = 'rickhuang'; // required: replace example with your forum shortname

        (function() {
            var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
            dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
            (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
        })();
    </script>
    <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
    <a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
</div>
</body>
</html>
